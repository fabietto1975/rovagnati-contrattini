<?php

namespace backend\app\service;

use backend\app\dao\ClienteDAO;

class ClienteService {

    private $clienteDAO;

    public function __construct() {
        $this->clienteDAO = new ClienteDAO();
    }
    
        
    public function read(){
        $res = $this->clienteDAO->read();
        if ($res==null){
            return array(
                'status' => 'fail',
                'message' => 'nessun cliente trovato',
                'error' => 'NO_DATA'
            );
        } 
        return array(
            'res' => $res,
            'status' => 'success'
        );

    }
    
    public function readById($id){
        $res = $this->clienteDAO->readById($id);
        if ($res==null){
            return array(
                'status' => 'fail',
                'message' => 'nessun cliente trovato',
                'error' => 'NO_DATA'
            );
        } 
        return array(
            'res' => $res,
            'status' => 'success'
        );

    }

    public function readByFatturazione($id,$anno){
        $cliente = $this->readById($id)['res'][0];
        
        $elencoCF = $this->clienteDAO->elencoCodiciCF($cliente['ct']);
        $datiFatturazione = $this->clienteDAO->readDatiFatturazione($cliente['ct'],$anno);
        if ($datiFatturazione==null){
            return array(
                'status' => 'fail',
                'message' => 'nessun dato di fatturazione trovato',
                'error' => 'NO_DATA'
            );
        } 
        return array(
            'res' => array( 'codiciCF' => $elencoCF, 'datiFatturazione' => $datiFatturazione),
            'status' => 'success'
        );

    }

    
    

}
